@{
    Layout = "~/TicTacToe/Game/Views/Shared/_GamesLayout.cshtml";
}

<div class="game__container">
    <h2>Choose your game</h2>
    <ul class="game-list__container">
        <li class="game-list__item">
            <div class="game-linkfield" data-link="/games/tictactoe">
                Go! TicTacToe
            </div>
        </li>
    </ul>
</div>

<div class="enemy__container">
    <h2>Choose your Enemy</h2>
    <ul class="enemy-list__container">
        <li v-for="user in userOnline" v-show="user !== currentUser" v-bind:key="user" class="enemy-list__item">
            {{user}}
        </li>
    </ul>
</div>

<button class="button button-start">Go!</button>

<script>
    var gameVue = new Vue({
        el: 'section.game',
        data: {
            userOnline: '',
            currentUser: '',
            connection: null
        },
        created: function () {
            this.connection = new signalR.HubConnection("/game/")
        },
        mounted: function () {
            var that = this;
            that.connection.start()
                .then(() => {
                    that.currentUserId =
                        that.connection.connection.connectionId;

                    that.connection
                        .invoke('GetConnectedUser', that.currentUserId);
                });
            that.connection.on('SetConnectedUser', function (userOnline, currentUser) {
                debugger;
                that.userOnline = userOnline;
                that.currentUserId = $.get('/Games/GetCurrentUserById?conId=' + that.connection.connection.connectionId);
            });
        },
        methods: {
        }
    })
</script>